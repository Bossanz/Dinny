<div class="flex min-h-[100vh] bg-bg">
  <!-- Sidebar -->
  <app-sidebar></app-sidebar>

  <!-- Main Content -->
  <main class="flex-1 min-h-screen p-6">
    <div
      class="grid grid-cols-[480px_1fr] gap-10 w-full max-w-[1200px] mx-auto"
    >
      <!-- üîπ ‡∏ã‡πâ‡∏≤‡∏¢: ‡∏ï‡∏≤‡∏£‡∏≤‡∏á + ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ -->
      <div class="flex flex-col gap-10">
        <!-- ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ -->
        <div
          class="bg-white rounded-2xl shadow-md p-6 max-h-[440px] w-[470px] flex flex-col"
        >
          <h2 class="text-xl font-semibold mb-4">‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÑ‡∏£‡πÄ‡∏î‡∏≠‡∏£‡πå</h2>

          <div class="overflow-y-auto max-h-[340px]">
            <table class="w-full text-left text-gray-700">
              <thead class="sticky top-0 bg-white border-b">
                <tr class="text-gray-600 text-sm">
                  <th class="pb-3">Username</th>
                  <th class="pb-3">Email</th>
                  <th class="pb-3 text-right">Action</th>
                </tr>
              </thead>
              <tbody>
                <tr
                  *ngFor="let r of riders"
                  class="border-b hover:bg-gray-50 transition text-sm"
                >
                  <td class="py-3">{{ r.rid_name }}</td>
                  <td class="py-3">{{ r.rid_email }}</td>
                  <td class="py-3 text-right">
                    <button
                      class="bg-blue-100 text-blue-600 px-3 py-1 rounded-md hover:bg-blue-200 transition"
                      (click)="openRiderDetail(r)"
                    >
                      ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö
                    </button>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>

        <!-- ‡∏Å‡∏•‡πà‡∏≠‡∏á Admin / Restaurants / Rider -->
        <div
          class="bg-white rounded-2xl shadow-md p-6 flex flex-col justify-between w-[470px]"
        >
          <h2 class="text-xl font-semibold mb-4">‡∏õ‡∏£‡∏±‡∏ö‡∏Ñ‡πà‡∏≤‡∏™‡∏±‡∏î‡∏™‡πà‡∏ß‡∏ô</h2>
          <div class="grid grid-cols-1 gap-4 text-lg font-semibold">
            <!-- Admin -->
            <div class="flex items-center justify-between">
              <span>‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô</span>
              <input
                type="number"
                [(ngModel)]="ad[0].ad_share_rate"
                class="w-40 text-center border rounded-md py-1 px-2 bg-gray-50"
              />
            </div>

            <!-- Restaurants -->
            <div class="flex items-center justify-between">
              <span>‡∏£‡πâ‡∏≤‡∏ô‡∏≠‡∏≤‡∏´‡∏≤‡∏£</span>
              <input
                type="number"
                [(ngModel)]="ad[0].res_share_rate"
                class="w-40 text-center border rounded-md py-1 px-2 bg-gray-50"
              />
            </div>

            <!-- Rider -->
            <div class="flex items-center justify-between">
              <span>‡πÑ‡∏£‡πÄ‡∏î‡∏≠‡∏£‡πå</span>
              <input
                type="number"
                [(ngModel)]="ad[0].rid_share_rate"
                class="w-40 text-center border rounded-md py-1 px-2 bg-gray-50"
              />
            </div>
          </div>

          <!-- ‡∏õ‡∏∏‡πà‡∏° Save -->
          <div class="mt-6 flex justify-end">
            <button
              (click)="saveShareRate()"
              class="bg-green-600 text-white px-6 py-2 rounded-md hover:bg-green-700 transition"
            >
              ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å
            </button>
          </div>
        </div>
      </div>

      <!-- üîπ ‡∏Ç‡∏ß‡∏≤: ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏õ‡∏±‡∏ç‡∏´‡∏≤ -->
      <div
        class="bg-white rounded-2xl shadow-md p-6 max-h-[calc(100vh-48px)] overflow-y-auto"
      >
        <h2 class="text-xl font-semibold mb-4">‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏õ‡∏±‡∏ç‡∏´‡∏≤</h2>
        <div
          *ngFor="let report of reports"
          class="border border-gray-200 rounded-xl p-4 mb-4 hover:shadow-md transition bg-white"
        >
          <div class="flex justify-between items-start">
            <div class="min-w-0">
              <strong class="text-red-500">{{ report.entity_name }}</strong>
              <small class="ml-2 text-gray-400">{{
                report.report_date | date : "dd/MM/yyyy"
              }}</small>
              <p class="font-medium text-gray-700 mt-1">
                {{ report.report_topic }}
              </p>
              <p class="text-gray-500 text-sm truncate">
                {{ report.description }}
              </p>
            </div>
            <button
              class="p-1 rounded hover:bg-gray-100"
              (click)="openReport(report)"
            >
              <svg
                xmlns="http://www.w3.org/2000/svg"
                fill="none"
                viewBox="0 0 24 24"
                stroke-width="1.5"
                stroke="currentColor"
                class="w-6 h-6 text-gray-500 hover:text-black"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  d="M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"
                />
              </svg>
            </button>
          </div>
        </div>
      </div>
    </div>
  </main>
</div>

<!-- üîπ Popup Modal -->
<div
  *ngIf="selectedRider"
  class="fixed inset-0 backdrop-blur-md bg-white/20 flex justify-center items-center z-50"
>
  <div
    class="bg-white rounded-2xl shadow-2xl w-[480px] p-8 relative border border-gray-100"
  >
    <button
      class="absolute top-4 right-4 text-gray-400 hover:text-black text-xl"
      (click)="selectedRider = null"
    >
      ‚úï
    </button>

    <h2 class="text-2xl font-semibold mb-5 text-center">Rider Details</h2>

    <div class="space-y-2 text-gray-700">
      <p><strong>‡∏ä‡∏∑‡πà‡∏≠‡πÑ‡∏£‡πÄ‡∏î‡∏≠‡∏£‡πå:</strong> {{ selectedRider.rid_name }}</p>
      <p><strong>‡∏£‡∏´‡∏±‡∏™‡πÑ‡∏£‡πÄ‡∏î‡∏≠‡∏£‡πå:</strong> {{ selectedRider.rid_id }}</p>
      <p><strong>‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡πÑ‡∏£‡πÄ‡∏î‡∏≠‡∏£‡πå:</strong> {{ selectedRider.rid_email }}</p>
    </div>

    <div class="mt-5">
      <!-- Vehicle -->
      <p class="font-medium text-gray-700 mb-2">‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏£‡∏ñ:</p>
      <img
        [src]="selectedRider.rid_vehicle_image"
        alt="Vehicle"
        class="rounded-xl mb-4 w-full h-[200px] object-contain border cursor-pointer"
        (click)="openImage(selectedRider.rid_vehicle_image)"
      />

      <!-- Driver License -->
      <p class="font-medium text-gray-700 mb-2">‡πÉ‡∏ö‡∏Ç‡∏±‡∏ö‡∏Ç‡∏µ‡πà:</p>
      <img
        [src]="selectedRider.rid_driv_license_image"
        alt="License"
        class="rounded-xl w-full h-[200px] object-contain border cursor-pointer"
        (click)="openImage(selectedRider.rid_driv_license_image)"
      />
    </div>

    <!-- ‡∏õ‡∏∏‡πà‡∏° Verify -->
    <div class="flex justify-end gap-3 mt-6">
      <button
        class="bg-gray-200 text-gray-700 px-5 py-2 rounded-md hover:bg-gray-300 transition"
        (click)="selectedRider = null"
      >
        ‡∏õ‡∏¥‡∏î
      </button>
      <button
        class="bg-purple-600 text-white px-6 py-2 rounded-md hover:bg-purple-700 transition"
        (click)="verifyRider(selectedRider)"
      >
        ‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥
      </button>
    </div>
  </div>

  <!-- Fullscreen Image -->
  <div
    *ngIf="selectedImage"
    class="fixed inset-0 z-50 bg-black/80 flex justify-center items-center"
    (click)="closeImage()"
  >
    <img
      [src]="selectedImage"
      alt="Full Screen"
      class="max-w-full max-h-full object-contain rounded-xl shadow-2xl"
    />
  </div>
</div>

<div
  *ngIf="selectedreport"
  class="fixed inset-0 backdrop-blur-md bg-white/20 flex justify-center items-center z-50"
>
  <div class="bg-white rounded-2xl p-6 w-[480px] border shadow-xl relative">
    <!-- ‡∏õ‡∏∏‡πà‡∏° ‚úï ‡∏≠‡∏¢‡∏π‡πà‡∏ö‡∏ô modal ‡∏™‡∏µ‡∏Ç‡∏≤‡∏ß -->
    <button
      class="absolute top-4 right-4 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-full w-8 h-8 flex justify-center items-center"
      (click)="closeReport()"
    >
      ‚úï
    </button>

    <div>
      <strong class="text-red-500">{{ selectedreport.entity_name }}</strong>
      <small class="ml-2 text-gray-400">{{
        selectedreport.report_date | date : "dd/MM/yyyy"
      }}</small>
      <p class="font-medium text-gray-700 mt-1">
        {{ selectedreport.report_topic }}
      </p>
      <p class="text-gray-500 text-sm">{{ selectedreport.description }}</p>
      <p>{{ selectedreport.source }}</p>
    </div>
  </div>
</div>
